#!/usr/bin/env node

var exec = require('child_process').exec
var join = require('path').join

var manager = require('download-manager')


const DEPS='deps'


// Source versions

const GENFATFS_VERSION = "master"
const SYSLINUX_VERSION = "6.03"


// Dependencies URLs

const GENFATFS_URL="https://github.com/NodeOS/genfatfs/archive/"+GENFATFS_VERSION+".tar.gz"
const SYSLINUX_URL="https://www.kernel.org/pub/linux/utils/boot/syslinux/syslinux-"+SYSLINUX_VERSION+".tar.gz"


//
// Download dependencies
//

var downloads =
[
  {
    name: 'genfatfs',
    url: GENFATFS_URL,
    action: function(callback)
    {
      exec('make', {cwd: join(DEPS, this.name)}, callback)
    }
  },

  {
    name: 'syslinux',
    url: SYSLINUX_URL
  }
]


manager(downloads, {path: DEPS}, function(error)
{
  if(error) throw error;
})
